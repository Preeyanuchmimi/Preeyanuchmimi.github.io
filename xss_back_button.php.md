ปัญหาที่พบคือ ช่องโหว่ Cross-Site Scripting (XSS) แบบ Reflected
สาเหตุเกิดจากระบบนำข้อมูลที่ผู้ใช้สามารถควบคุมได้ (HTTP_REFERER) ไปแสดงผลบนหน้าเว็บโดยตรง ทำให้ข้อมูลดังกล่าวสามารถถูกดัดแปลงให้แทรกโค้ด JavaScript อันตรายได้
ช่องโหว่นี้อาจทำให้ผู้โจมตีสามารถรันสคริปต์ในเบราว์เซอร์ของผู้ใช้งาน ส่งผลให้เกิดการขโมยคุกกี้ ขโมยเซสชัน เปลี่ยนหน้าเว็บ หรือหลอกลวงผู้ใช้ (phishing)
สรุปคือ ระบบมีการนำข้อมูลจากภายนอกมาแสดงผลโดยไม่มีการป้องกันที่เพียงพอ ทำให้เกิดช่องโหว่ด้านความปลอดภัยประเภท Cross-Site Scripting (XSS)

![cf](1.1.png)

วิธ๊การแก้ไข
ขั้นตอนการแก้ไข

1.ระบุจุดที่รับข้อมูลจากผู้ใช้ (Source)
ตรวจสอบว่ามีการรับค่าจากตัวแปรที่ผู้ใช้ควบคุมได้ เช่น GET, POST, COOKIE หรือ HTTP_REFERER


![cf](1.3.png)


2.ตรวจสอบจุดที่นำข้อมูลไปแสดงผล (Sink)
ค้นหาว่าข้อมูลดังกล่าวถูกนำไปแสดงผลบนหน้าเว็บหรือฝังใน HTML/JavaScript ตรงไหน


![cf](1.2.png)


3.หลีกเลี่ยงการนำข้อมูลไปฝังใน JavaScript โดยตรง
ไม่ควรนำค่าจากผู้ใช้ไปใส่ใน event handler หรือ script โดยตรง เพราะเสี่ยงต่อการถูกแทรกโค้ด

![cf](1.4.png)



กำหนดแนวปฏิบัติว่า ทุกครั้งที่นำข้อมูลจากผู้ใช้มาแสดงผล ต้องผ่านการเข้ารหัสเสมอ
